# About ArkProjects.XUnit
![Nuget](https://img.shields.io/nuget/v/ArkProjects.XUnit?style=flat-square)
![GitHub Workflow Status](https://img.shields.io/github/workflow/status/mixa3607/ArkProjects.XUnit/build?style=flat-square)

Данный проект содержит некоторые дополнения для упрощения написания xUnit тестов


## ArkProjects.XUnit.Json
Предоставляет набор классов и аттрибудтов для интеграции json в xUnit.

### АТТРИБУТЫ
### `JsonData`
Применяется к тестовому методу и является аналогией InlineData/ClassData/etc. 
Конструктор принимает строку в качестве пути к файлу json (его структура будет ниже). А так же есть параметр `DisableDiscoveryEnumeration` при установке которого в `true` будет выключено автоматическое обнаружение тест кейсов перед запуском.

В пути к файлу действуют подстановки:
- `{class}` => название класса в котором расположен метод
- `{method}` => название метода к которому применён атрибут

К примеру в данном случае
```
public class JsonDataAttributeTests
{
    [Theory]
    [JsonData("./files/tests/{class}_{method}/data.json")]
    public void Test1(string value){}
}
```
В результате будет попытка загрузить файл по пути `./files/tests/JsonDataAttributeTests_Test1/data.json`

### `XUnitJsonFileName`
При применении к проперти в классе (для вложенных не работает) который будет десериализован из json подставит в это поле индекс тест кейса в исходном файле

### `XUnitJsonCaseIndex`
При применении к проперти в классе (для вложенных не работает) который будет десериализован из json подставит в это поле путь к файлу json

### КЛАССЫ
### `JsonDataBuilder`
Используется для построения файлов с тест кейсами

### `XUnitJsonSerializable`
Если в качестве параметров используются сложные объекты и для них xUnit не имеет сериализатора то можно использовать данный класс. Он имплементирует методы сериализации и десериализации требующиеся xUnit.
Так же переопределяет `ToString()` на сериализацию объекта в строку

## Структура используемых json
```
{
  "DataType": "Auto",
  "TestCases": [
    "DATA1",
    "DATA2"
  ]
}
```
Наборы тестовых данных лежат в массиве `TestCases`. Содержимое каждого элемента может менятся в зависимости от `DataType`
В корне файла есть поле `DataType` которое может принимать значения:
- Auto - автоматическое определение (по умолчанию)
- SingleParam - каждый объект будет считаться параметром к тестовому методу(с одним параметром)
- MultiParams - каждый объект должен быть либо массивом (каждый его объект это параметр в метод по счёту) либо словарём (название_параметра <=> данные)
